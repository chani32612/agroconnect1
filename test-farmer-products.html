<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Farmer Products</title>
    <script src="auth.js"></script>
    <script src="farmer-products.js"></script>
</head>
<body>
    <h1>Test Farmer Products Functionality</h1>
    <div id="test-results"></div>
    
    <script>
        // Test the farmer products functionality
        function runTests() {
            const results = document.getElementById('test-results');
            
            // Mock a farmer user
            const mockUser = {
                id: 1,
                username: 'farmer101',
                email: 'farmer101@email.com',
                role: 'farmer',
                details: {
                    full_name: 'Ravi Patel',
                    phone: '9876543210',
                    location: 'Ahmedabad, Gujarat'
                }
            };
            
            // Store mock user in localStorage
            localStorage.setItem('currentUser', JSON.stringify(mockUser));
            
            results.innerHTML = '<h2>Test Results:</h2>';
            
            // Test 1: Get farmer products (should be empty initially)
            const products = getFarmerProducts();
            results.innerHTML += `<p>✓ getFarmerProducts() returned: ${products.length} products</p>`;
            
            // Test 2: Add a product
            const testProduct = {
                name: 'Test Tomatoes',
                category: 'Vegetables',
                description: 'Fresh organic tomatoes',
                price: 50,
                quantity: 20,
                unit: 'kg',
                harvest_date: '2024-01-20',
                expiry_date: '2024-01-30',
                location: 'Test Farm, Gujarat',
                organic: true,
                image_url: 'https://example.com/tomato.jpg'
            };
            
            const addedProduct = addProduct(testProduct);
            if (addedProduct) {
                results.innerHTML += `<p>✓ addProduct() successfully added: ${addedProduct.name}</p>`;
            } else {
                results.innerHTML += `<p>✗ addProduct() failed</p>`;
            }
            
            // Test 3: Get products again (should have 1 now)
            const updatedProducts = getFarmerProducts();
            results.innerHTML += `<p>✓ After adding, getFarmerProducts() returned: ${updatedProducts.length} products</p>`;
            
            // Test 4: Update product
            if (updatedProducts.length > 0) {
                const updated = updateProduct(updatedProducts[0].id, { price: 60 });
                if (updated) {
                    results.innerHTML += `<p>✓ updateProduct() successfully updated price to: ₹${updated.price}</p>`;
                } else {
                    results.innerHTML += `<p>✗ updateProduct() failed</p>`;
                }
            }
            
            results.innerHTML += '<p><strong>All tests completed! Check the browser console for any errors.</strong></p>';
        }
        
        // Run tests when page loads
        window.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>